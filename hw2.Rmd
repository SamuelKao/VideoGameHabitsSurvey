---
title: "hw2"
output: pdf_document
date: "2024-10-21"
---
# 1. Introduction
The purpose of the survey conducted at the University of California, Berkeley, was to gain a deeper understanding of the gaming habits and preferences of students enrolled in statistics courses during the Fall 1994 semester. By targeting a specific cohort of 314 eligible students from Statistics 2, Section 1, the researchers aimed to gather data on how frequently these students engaged in video gaming and their likes and dislikes related to the activity.

# 2. Analysis
```{r}
#read data
videodata <- read.table("videodata.txt",header =TRUE)
videodata

```




```{r}
#read data
videoMultiple <- read.table("videoMultiple.txt",header = TRUE)
videoMultiple
```

1. 
### Method

```{r}
#find the point estimator
point_estimate_fraction <- sum(videodata$time >0) / length(videodata$time)

confidence_level <- 0.95
z <- qnorm((confidence_level+1)/2)

#find proportion standard error
se <- sqrt(point_estimate_fraction * (1-point_estimate_fraction)) / sqrt(length(videodata))

#find lower and upper confidence interval
lower_interval_estimate_fraction <- point_estimate_fraction - 2 * se
lower_interval_estimate_fraction

higher_interval_estimate_fraction <- point_estimate_fraction + 2*se
higher_interval_estimate_fraction
se
videodata
```
### Analysis
We aim to estimate the proportion of students who played video games in the week before the survey using two methods:

The point estimate is 0.37. This is the best single estimate of the proportion based on the sample data. This means that approximately 37% of the students surveyed played a video game in the past week.

With a 95% confidence level, we estimate that the true proportion lies between 0.12 and 0.62. This range accounts for the uncertainty in the estimate, with the standard error being 0.12.

The point estimate provides a specific value, but the interval estimate acknowledges the uncertainty, offering a range where the true proportion is likely to fall.

### Conclusion
The distinction between these two estimates is for understanding the limitations of our inference. While the point estimate provides a single value, it does not account for the inherent variability in sampling. The confidence interval offers a range that acknowledges the uncertainty and gives a more comprehensive picture of where the true proportion likely lies.



2. 
```{r}
# Filter out rows
videodata_clean <- videodata[!is.na(videodata$freq) & videodata$freq != 99, ]

avg_time <- tapply(videodata_clean$time, videodata_clean$freq, mean, na.rm = TRUE)
sd_time <- tapply(videodata_clean$time, videodata_clean$freq, sd, na.rm = TRUE)
count <- table(videodata_clean$freq)

# summary statistics
summary_stats <- data.frame(
    freq = names(avg_time),
    avg_time = as.numeric(avg_time),
    sd_time = as.numeric(sd_time),
    count = as.numeric(count)
)

print(summary_stats)

# Barplot of average time spent per frequency category
barplot(summary_stats$avg_time,
    names.arg = summary_stats$freq,
    main = "Average Time Spent by Reported Frequency",
    xlab = "Reported Frequency of Play",
    ylab = "Average Time Spent (hours)",
    ylim = c(0, max(summary_stats$avg_time, na.rm = TRUE) + 2)
)
```
```{r}
# Boxplot of time spent by frequency category
boxplot(time ~ freq,
    data = videodata_clean,
    main = "Time Spent Playing Video Games by Reported Frequency",
    xlab = "Reported Frequency of Play",
    ylab = "Time Spent (hours)"
)
```
The average time spent by students who reported playing daily was approximately 4.44 hours for the week. This translates to less than 1 hour per day on average, which is low given their self-categorization.

This suggests that the frequency of daily gaming sessions might be short, which may be due to casual gamers (given the dataset was created in 1994, mobile gaming can be reasonably ignored).
The high standard deviation (5.57) implies significant variability, with some daily players playing much longer than others, indicating the presence of outliers or different interpretations of what "daily play" means.

Students who reported playing weekly spent an average of 2.54 hours in the prior week. The standard deviation is also quite high (5.50), indicating a wide range of weekly playtime. The variability could be due to students engaging in longer gaming sessions occasionally but not consistently.

Notably, there are pretty significant outliers in both categories, with the most extreme being a 30 hour playtime for someone in the weekly categorization.

Monthly and Semesterly Players: The averages for these groups are extremely low.

Monthly: 0.056 hours 

Semesterly: 0.043 hours

These figures suggest minimal engagement with video games, aligning with their infrequent gaming habits.

The survey was conducted following a week that included exams, which likely influenced the reported and actual gaming behaviors.

Reduced Gaming Time: An exam week would lead to students to allocate more time to studying. This would likely result in a temporary decrease in gaming time, especially for those who usually play more frequently.

This could explain the low average gaming hours for the "Daily" category, where students, despite reporting daily gaming habits, might have significantly shortened their gaming time during exams.
The exam effect may have impacted the accuracy of the Weekly group as well, reducing the typical number of hours they would have played in a regular week without exams.
Skewed Estimates: The data collected during an atypical exam week might not accurately represent students' normal gaming habits. The extreme outliers may stand out due to average gaming time decreasing. (eg. a few students didn't have exams or didn't care)

Point Estimate Impact: The point estimate for the proportion of students who played video games during the week might be lower than usual due to the reduced engagement during exams.

Confidence Intervals: The confidence intervals calculated in Question 1 may be biased downward, as the variability in playtime could be different in a regular week. The exam week’s reduction in gaming likely compressed the range of playtimes, affecting standard error calculations.



3. 
### Methods
```{r}
#find the point estimator
point_estimate_average <- mean(videodata$time)

confidence_leve <- 0.95
z <- qnorm((1+confidence_level)/2)

#get the variance of data
variance <- 1/length(videodata$time) * sum((videodata$time - point_estimate_average)**2)

#find average standard error
se <- sqrt(variance) / sqrt (length(videodata$time))

#lower and upper 95% confidence interval
lower_interval_estimate_average <- point_estimate_average - 2*se
higher_interval_estimate_average <- point_estimate_average + 2*se

lower_interval_estimate_average
higher_interval_estimate_average
```
### Analysis
The average time spent playing video games in the week prior to the survey is represented by the point estimate of 1.24 hours. This average provides a summary measure of how much time, on average, respondents dedicated to gaming during that week.

The shape of the sample distribution plays a critical role in determining the appropriateness of this interval estimate. If the distribution of the data is approximately normal, the interval estimate is considered reliable. In case the distribution is skewed or exhibits outliers, further examination through a simulation study can help validate the confidence interval. The simulation can assess the robustness of our interval estimate by generating numerous resamples to observe the distribution of sample means and the resulting confidence intervals.

### Conclusion

Overall, this analysis highlights the average gaming habits of students while acknowledging the variability and potential limitations of the data. It underscores the importance of understanding the underlying distribution when making estimates, as this directly affects the reliability of our conclusions. Further validation through simulation could enhance confidence in our interval estimate, ensuring it accurately reflects the true population parameters.



4.
### Method
```{r}

like_to_play <- videoMultiple[, c("relax", "coord","challenge","graphic","master","bored")]
like_to_play[] <- lapply(like_to_play, function(x) as.numeric(as.character(x)))

# Count the number of 1s in each column
count_ones <- sapply(like_to_play, function(x) sum(x == 1, na.rm = TRUE))

# Sort and get the names of the top 2 columns with the most 1s
top_2_like <- names(sort(count_ones, decreasing = TRUE)[1:2])


not_like_to_play <- videoMultiple[, c("time", "frust","lonely","rules","cost","boring","friends","point")]

not_like_to_play[] <- lapply(not_like_to_play, function(x) as.numeric(as.character(x)))
count_ones <- sapply(not_like_to_play, function(x) sum(x == 1, na.rm = TRUE))
top_2_dislike <- names(sort(count_ones, decreasing = TRUE)[1:2])


reasons_for_likeliness = "Like: relax, master. Dislike: time, cost"
```
### Analysis
The analysis of student attitudes toward video games reveals that enjoyment often comes from two main reasons: relaxation and mastery. Many students see video games as a way to unwind and escape from the stresses of school. They also enjoy the challenge of improving their skills and achieving new levels in games. However, several factors lead some students to dislike video games. Time constraints are significant, as students juggle busy schedules with classes and activities, making it hard to find time for gaming. Additionally, the cost of games and gaming equipment can be a burden for those on tight budgets. Students who don’t play or dislike video games often skip questions about their educational value or gaming habits, which limits understanding of their views.

### Conclusion
In conclusion, student attitudes toward video games are shaped by both positive and negative factors. While many appreciate the relaxation and sense of achievement that gaming offers, others are put off by the time and financial commitments involved. Further research is needed to understand the perspectives of students who do not engage with video games, as their insights could help improve gaming experiences. Overall, recognizing these attitudes can help educators and game developers create more appealing and accessible gaming options for students.



5.
```{r}
video_data_like_cleaned <- videodata[videodata$like != 99, ]

video_data_work_cleaned <- video_data_like_cleaned[video_data_like_cleaned$work != 99,]

video_data_work_cleaned$work[video_data_work_cleaned$work != 0 ] <- 1


gender_vs_games <- table(video_data_like_cleaned$sex, video_data_like_cleaned$like)

work_vs_games <- table(video_data_work_cleaned$work, video_data_work_cleaned$like)

computer_vs_games <- table(video_data_like_cleaned$own, video_data_like_cleaned$like)

barplot(gender_vs_games, beside = TRUE, col = c("blue", "red"),
        main = "Gender vs. Likes Video Games",
        xlab = "Like to play", ylab = "Count",
        las = 2, cex.axis = 0.8,  # Increase text size for better visibility
        legend = c("Female", "Male"),
        names.arg = c("Never Played", "Very Much", "Somewhat", "not really", "not at all"),,
        cex.names = 0.8,
        mgp = c(4.2, 1, 0))  # Adjust label size and spacing



# Call the function with your data

# Works for Pay vs. Likes Video Games
barplot(work_vs_games, beside = TRUE, col = c("blue", "red"),
        main = "Work vs. Likes Video Games",  # Main title
        xlab = "Like to play", ylab = "Count",  # Axis labels
        las = 2, cex.axis = 0.8,  # Rotate x-axis labels and adjust font size
        legend = c("No Work", "Work"),  # Legend labels
        names.arg = c("Never Played", "Very Much", "Somewhat", "not really", "not at all"),  # X-axis labels
        cex.names = 0.8,  # Adjust x-axis label font size
        mgp = c(4.2, 1, 0))



# Works for Pay vs. Likes Video Games
barplot(computer_vs_games, beside = TRUE, col = c("blue", "red"),
        main = "Owns Computer vs. Likes Video Games", 
        xlab = "Like to play", ylab = "Count",
        las = 2, cex.axis = 0.8,  # Increase text size for better visibility
        legend = c("No PC", "Have PC"),
        names.arg = c("Never Played", "Very Much", "Somewhat", "not really", "not at all"),
        cex.names = 0.8,
        mgp = c(4.2, 1, 0)) 

```

### Analysis
Gender Comparison:
Males generally show a higher preference for video games compared to females. For instance, more males fall into the "Very Much" and "Somewhat" categories for liking video games, while females tend to have lower numbers in these categories.
Both genders have a small number of individuals who "Never Played" video games or do not like them at all, but the proportion of females who "Not really" or "Not at all" enjoy games is slightly higher than that of males.


Work Status Comparison:
Those who work for pay also show a significant interest in video games, with a considerable number in the "Very Much" and "Somewhat" categories. However, the group that does not work tends to have a slightly higher representation in the "Somewhat" category, indicating they might enjoy gaming but not as passionately as those who work.
A relatively small number of individuals in both groups (working and non-working) fall under the "Not really" or "Not at all" categories, but those who work for pay generally express a greater interest in gaming overall.


Computer Ownership Comparison:
Those who own a computer show a much stronger preference for video games, especially in the "Very Much" and "Somewhat" categories, indicating a clear association between computer ownership and interest in gaming.
The "Not really" and "Not at all" categories are primarily occupied by those who do not own a computer, suggesting that a lack of computer ownership correlates with a lesser interest in gaming.

###Conclusion:
These graphs suggest that gender, work status, and computer ownership influence interest in video games. Males, individuals who work for pay, and those who own computers are generally more inclined to enjoy gaming, especially in higher engagement categories. In contrast, females, those without work, and individuals without computers are more likely to have a moderate or lower interest in video games. This data could be useful in understanding demographic trends in gaming preferences and can guide decisions in marketing and content creation within the gaming industry.

6. 
```{r}

# Map numeric grades to letter grades
videodata$grade <- factor(videodata$grade, levels = c(4, 3, 2), labels = c("A", "B", "C"))

# Calculate total number of students
total_students <- nrow(data)

# Count grades distribution among respondents
grade_counts <- prop.table(table(data$grade))

# Assume non-respondents as failing (D or lower) and adjust
respondents <- length(na.omit(videodata$grade))
non_respondents <- sum(rowSums(is.na(videoMultiple)) > 0)

# Create adjusted grade distribution
adjusted_grade_counts <- grade_counts
adjusted_grade_counts <- c(adjusted_grade_counts, D_or_lower = non_respondents / total_students)

# Normalize to get adjusted distribution including non-respondents as failing
adjusted_grade_distribution <- adjusted_grade_counts / sum(adjusted_grade_counts)

# Display results
cat("Observed grade distribution:\n")
print(grade_counts)
cat("\nAdjusted grade distribution (assuming non-respondents as D or lower):\n")
print(adjusted_grade_distribution)

# Define target distribution
target_distribution <- c(A = 0.2, B = 0.3, C = 0.4, D_or_lower = 0.1)
cat("\nTarget grade distribution:\n")
print(target_distribution)
```

